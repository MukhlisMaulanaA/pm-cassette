<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PM Cassette</title>

  <link rel="stylesheet" href="css/style.css">
</head>

<body>

  <main class="container">

    <!-- HEADER VISIT (READ-ONLY) -->
    <section id="visitHeader" class="card">
      <h2>Visit Information</h2>

      <div class="visit-row">
        <span class="label">PKT</span>
        <span id="visit-pkt">-</span>
      </div>

      <div class="visit-row">
        <span class="label">Visit Date</span>
        <span id="visit-date">-</span>
      </div>

      <div class="visit-row">
        <span class="label">Bank</span>
        <span id="visit-bank">-</span>
      </div>

      <div class="visit-row">
        <span class="label">Engineer</span>
        <span id="visit-engineer">-</span>
      </div>

      <div class="visit-row">
        <span class="label">OK</span>
        <span id="visit-ok">-</span>
      </div>

      <div class="visit-row">
        <span class="label">NG</span>
        <span id="visit-ng">-</span>
      </div>

      <div class="visit-row">
        <span class="label">Total NG + OK</span>
        <span id="visit-total"></span>
      </div>

      <!-- <header class="visit-header">
        <div><strong>Visit ID:</strong> <span id="id"></span></div>
        <div><strong>Engineer:</strong> <span id="v-eng"></span></div>
        <div><strong>Date:</strong> <span id="v-date"></span></div>
      </header> -->
    </section>

    <!-- FORM PM CASSETTE -->
    <section class="card">
      <h2>Input PM Cassette</h2>

      <form id="pm-form">
        <label>
          RC Type
          <select id="cassetteType" required>
            <option value="">-- Pilih --</option>
            <option value="RC60">RC60</option>
            <option value="RJC">RJC</option>
          </select>
        </label>

        <label>
          Serial Number
          <div style="display:flex; gap:6px;">
            <input type="text" id="prefix" readonly style="width:90px;" />
            <input type="number" id="serialNumber" maxlength="6" pattern="[0-9]{6}" placeholder="000000" required />
          </div>
        </label>

        <label>
          Production Month
          <select id="productionMonth" required>
            <option value="">-- Pilih --</option>
            <option>Jan</option>
            <option>Feb</option>
            <option>Mar</option>
            <option>Apr</option>
            <option>May</option>
            <option>Jun</option>
            <option>Jul</option>
            <option>Aug</option>
            <option>Sep</option>
            <option>Oct</option>
            <option>Nov</option>
            <option>Dec</option>
          </select>
        </label>

        <label>
          Production Year
          <input type="number" id="productionYear" />
        </label>

        <label>
          Revision
          <input type="number" id="revision" />
        </label>

        <label>
          Action
          <select id="action" required>
            <option value="">-- Pilih --</option>
            <option value="CHECK">CHECK</option>
            <option value="CLEAN">CLEAN</option>
            <option value="ADJUST">ADJUST</option>
          </select>
        </label>


        <label>
          Status
          <select id="status" required>
            <option value="">-- Pilih --</option>
            <option value="OK">OK</option>
            <option value="NG">NG</option>
          </select>
        </label>

        <label>
          Notes
          <input type="text" id="notes">
        </label>

        <button type="submit">Add</button>
      </form>
    </section>

    <section class="table-section">
      <h3>PM Cassette List</h3>

      <table id="pmTable">
        <thead>
          <tr>
            <th>No</th>
            <th>RC Type</th>
            <th>Serial Number</th>
            <th>Prod. Month</th>
            <th>Year</th>
            <th>Rev</th>
            <th>Action</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody id="pm-table-body"></tbody>
      </table>
      <button id="export-xlsx" class="btn-export">
        Export Report
      </button>
    </section>

  </main>

  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/exceljs/dist/exceljs.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <script type="module" src="js/db.js"></script>
  <script type="module" src="js/pm.js"></script>
</body>

</html>